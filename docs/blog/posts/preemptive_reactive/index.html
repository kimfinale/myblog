<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jong-Hoon Kim">
<meta name="dcterms.date" content="2025-06-27">

<title>Disease modeling for public health - Optimizing Vaccination Strategies: Pre-emptive vs.&nbsp;Reactive Vaccination</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Disease modeling for public health</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog/index.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../research/index.html" rel="" target="">
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kimfinale" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/jong-hoon-kim-6447325/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/tarzanthoreau" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#defining-the-core-quantities" id="toc-defining-the-core-quantities" class="nav-link active" data-scroll-target="#defining-the-core-quantities"><span class="header-section-number">1</span> Defining the Core Quantities</a>
  <ul class="collapse">
  <li><a href="#pre-emptive-vaccination" id="toc-pre-emptive-vaccination" class="nav-link" data-scroll-target="#pre-emptive-vaccination"><span class="header-section-number">1.1</span> Pre-emptive Vaccination</a></li>
  <li><a href="#reactive-vaccination" id="toc-reactive-vaccination" class="nav-link" data-scroll-target="#reactive-vaccination"><span class="header-section-number">1.2</span> Reactive Vaccination</a></li>
  </ul></li>
  <li><a href="#comparison-of-two-strategies" id="toc-comparison-of-two-strategies" class="nav-link" data-scroll-target="#comparison-of-two-strategies"><span class="header-section-number">2</span> Comparison of two strategies</a>
  <ul class="collapse">
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation"><span class="header-section-number">2.1</span> Interpretation</a></li>
  </ul></li>
  <li><a href="#visualizing-the-threshold-probability" id="toc-visualizing-the-threshold-probability" class="nav-link" data-scroll-target="#visualizing-the-threshold-probability"><span class="header-section-number">3</span> Visualizing the Threshold Probability</a></li>
  <li><a href="#additional-benefits-of-pre-emptive-vaccination-and-the-cost-of-not-deploying-vaccines" id="toc-additional-benefits-of-pre-emptive-vaccination-and-the-cost-of-not-deploying-vaccines" class="nav-link" data-scroll-target="#additional-benefits-of-pre-emptive-vaccination-and-the-cost-of-not-deploying-vaccines"><span class="header-section-number">4</span> Additional benefits of pre-emptive vaccination and the cost of not deploying vaccines</a>
  <ul class="collapse">
  <li><a href="#pre-emptive-vaccination-1" id="toc-pre-emptive-vaccination-1" class="nav-link" data-scroll-target="#pre-emptive-vaccination-1"><span class="header-section-number">4.1</span> Pre-emptive Vaccination</a></li>
  <li><a href="#reactive-vaccination-1" id="toc-reactive-vaccination-1" class="nav-link" data-scroll-target="#reactive-vaccination-1"><span class="header-section-number">4.2</span> Reactive Vaccination</a></li>
  <li><a href="#visualizing-the-scenario" id="toc-visualizing-the-scenario" class="nav-link" data-scroll-target="#visualizing-the-scenario"><span class="header-section-number">4.3</span> Visualizing the scenario</a></li>
  </ul></li>
  <li><a href="#extending-to-multiple-sub-populations" id="toc-extending-to-multiple-sub-populations" class="nav-link" data-scroll-target="#extending-to-multiple-sub-populations"><span class="header-section-number">5</span> Extending to Multiple Sub-populations</a>
  <ul class="collapse">
  <li><a href="#strategy" id="toc-strategy" class="nav-link" data-scroll-target="#strategy"><span class="header-section-number">5.1</span> Strategy:</a></li>
  <li><a href="#numerical-illustration" id="toc-numerical-illustration" class="nav-link" data-scroll-target="#numerical-illustration"><span class="header-section-number">5.2</span> Numerical illustration</a></li>
  </ul></li>
  <li><a href="#further-extention" id="toc-further-extention" class="nav-link" data-scroll-target="#further-extention"><span class="header-section-number">6</span> Further extention</a>
  <ul class="collapse">
  <li><a href="#setting-and-assumptions" id="toc-setting-and-assumptions" class="nav-link" data-scroll-target="#setting-and-assumptions"><span class="header-section-number">6.1</span> Setting and Assumptions</a></li>
  <li><a href="#expected-benefits" id="toc-expected-benefits" class="nav-link" data-scroll-target="#expected-benefits"><span class="header-section-number">6.2</span> Expected Benefits</a></li>
  <li><a href="#opportunity-cost-of-preemptive-vaccination" id="toc-opportunity-cost-of-preemptive-vaccination" class="nav-link" data-scroll-target="#opportunity-cost-of-preemptive-vaccination"><span class="header-section-number">6.3</span> Opportunity Cost of Preemptive Vaccination</a></li>
  <li><a href="#refined-decision-rule" id="toc-refined-decision-rule" class="nav-link" data-scroll-target="#refined-decision-rule"><span class="header-section-number">6.4</span> Refined Decision Rule</a></li>
  <li><a href="#summary-of-key-formulas" id="toc-summary-of-key-formulas" class="nav-link" data-scroll-target="#summary-of-key-formulas"><span class="header-section-number">6.5</span> Summary of Key Formulas</a></li>
  </ul></li>
  <li><a href="#further-extention-1" id="toc-further-extention-1" class="nav-link" data-scroll-target="#further-extention-1"><span class="header-section-number">7</span> Further Extention</a>
  <ul class="collapse">
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions"><span class="header-section-number">7.1</span> Assumptions</a></li>
  <li><a href="#threshold-probability-for-preemptive-vaccination" id="toc-threshold-probability-for-preemptive-vaccination" class="nav-link" data-scroll-target="#threshold-probability-for-preemptive-vaccination"><span class="header-section-number">7.2</span> Threshold Probability for Preemptive Vaccination</a></li>
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1"><span class="header-section-number">7.3</span> Interpretation</a></li>
  <li><a href="#summary-of-final-model" id="toc-summary-of-final-model" class="nav-link" data-scroll-target="#summary-of-final-model"><span class="header-section-number">7.4</span> Summary of Final Model</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">8</span> Discussion</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">9</span> Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">10</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Optimizing Vaccination Strategies: Pre-emptive vs.&nbsp;Reactive Vaccination</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jong-Hoon Kim </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 27, 2025</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>When managing infectious disease risks such as cholera, limited vaccine supply often forces decision-makers to choose between <strong>pre-emptive</strong> and <strong>reactive</strong> vaccination campaigns. This post explores a cost-benefit model comparing the two strategies using analytical expressions and numerical simulations.</p>
<p>We aim to answer: <strong>Under what conditions is it better to vaccinate before an outbreak occurs, and when is it more beneficial to wait and respond reactively?</strong></p>
<section id="defining-the-core-quantities" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="defining-the-core-quantities"><span class="header-section-number">1</span> Defining the Core Quantities</h2>
<p>Let:</p>
<ul>
<li><span class="math inline">\(B\)</span>: The full benefit gained by averting an outbreak (e.g., DALYs or cases averted)</li>
<li><span class="math inline">\(C\)</span>: The cost of deploying one vaccination campaign</li>
<li><span class="math inline">\(p\)</span>: The probability of an outbreak in a given region</li>
<li><span class="math inline">\(r\)</span>: The effectiveness of a reactive campaign relative to pre-emptive one (e.g., <span class="math inline">\(r=0.6\)</span> means 60% as effective)</li>
</ul>
<section id="pre-emptive-vaccination" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="pre-emptive-vaccination"><span class="header-section-number">1.1</span> Pre-emptive Vaccination</h3>
<p>If we vaccinate before any outbreak, the expected benefit is <span class="math inline">\(B \cdot p\)</span>. However, we always incur the campaign cost <span class="math inline">\(C\)</span>, so the <strong>net expected benefit</strong> is:</p>
<p><span class="math display">\[
\text{Net}_{\text{pre}} = Bp - C
\]</span></p>
</section>
<section id="reactive-vaccination" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="reactive-vaccination"><span class="header-section-number">1.2</span> Reactive Vaccination</h3>
<p>For reactive vaccination, the benefit is only realized if an outbreak occurs (probability <span class="math inline">\(p\)</span>), and even then, only <span class="math inline">\(rB\)</span> is saved due to delays. The cost <span class="math inline">\(C\)</span> is only paid if an outbreak occurs. Hence:</p>
<p><span class="math display">\[
\text{Net}_{\text{react}} = Bpr - Cp
\]</span></p>
</section>
</section>
<section id="comparison-of-two-strategies" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="comparison-of-two-strategies"><span class="header-section-number">2</span> Comparison of two strategies</h2>
<p><span class="math display">\[
\text{Net}_{\text{pre}} - \text{Net}_{\text{react}} = pB(1 - r) - C(1 - p)
\]</span></p>
<section id="interpretation" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="interpretation"><span class="header-section-number">2.1</span> Interpretation</h3>
<p>Pre-emptive is better if:</p>
<p><span class="math display">\[
pB(1 - r) &gt; C(1 - p)
\]</span></p>
<p>Solving for <span class="math inline">\(p\)</span> gives the threshold outbreak probability <span class="math inline">\(p^*\)</span>:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define symbols</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>B, C, p, r <span class="op">=</span> sp.symbols(<span class="st">'B C p r'</span>, positive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Net benefits</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>net_pre   <span class="op">=</span> B<span class="op">*</span>p <span class="op">-</span> C</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>net_react <span class="op">=</span> B<span class="op">*</span>p<span class="op">*</span>r <span class="op">-</span> C<span class="op">*</span>p</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># When is pre-emptive better?</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>threshold_p <span class="op">=</span> sp.solve(net_pre <span class="op">-</span> net_react <span class="op">&gt;</span> <span class="dv">0</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[
p &gt; \frac{C}{B(1 - r) + C}
\]</span></p>
</section>
</section>
<section id="visualizing-the-threshold-probability" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="visualizing-the-threshold-probability"><span class="header-section-number">3</span> Visualizing the Threshold Probability</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a grid of r and p values</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>r_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>p_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute threshold for each r</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">p =</span> p_vals, <span class="at">r =</span> r_vals)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> grid <span class="sc">%&gt;%</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_star =</span> C <span class="sc">/</span> (B <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> r) <span class="sc">+</span> C),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">decision =</span> <span class="fu">ifelse</span>(p <span class="sc">&gt;</span> p_star, <span class="st">"Preemptive"</span>, <span class="st">"Reactive"</span>))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot heatmap</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(grid, <span class="fu">aes</span>(<span class="at">x =</span> r, <span class="at">y =</span> p, <span class="at">fill =</span> decision)) <span class="sc">+</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Preemptive"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"Reactive"</span> <span class="ot">=</span> <span class="st">"tomato"</span>)) <span class="sc">+</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Vaccination Strategy Decision Heatmap"</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Relative Reactive Benefit (r)"</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Outbreak Probability (p)"</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Strategy"</span>) <span class="sc">+</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This plot shows that reactive vaccination is better when <span class="math inline">\(p\)</span> is small, but pre-emptive takes over beyond a break-even point that depends on <span class="math inline">\(r\)</span>.</p>
</section>
<section id="additional-benefits-of-pre-emptive-vaccination-and-the-cost-of-not-deploying-vaccines" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="additional-benefits-of-pre-emptive-vaccination-and-the-cost-of-not-deploying-vaccines"><span class="header-section-number">4</span> Additional benefits of pre-emptive vaccination and the cost of not deploying vaccines</h2>
<p>We define two additional parameters:</p>
<ul>
<li><p><span class="math inline">\(\phi\)</span>: The benefit of vaccination when no outbreak occurs (e.g., due to future immunity or prevention). This applies to both pre-emptive and reactive strategies</p></li>
<li><p><span class="math inline">\(D\)</span>: The cost or penalty associated with unused vaccines (e.g., due to expiry or logistical waste). This applied to the reactive strategy.</p></li>
</ul>
<section id="pre-emptive-vaccination-1" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="pre-emptive-vaccination-1"><span class="header-section-number">4.1</span> Pre-emptive Vaccination</h3>
<p>If we vaccinate before any outbreak, the expected benefit includes two parts:</p>
<ul>
<li><span class="math inline">\(pB\)</span> when an outbreak is averted</li>
<li><span class="math inline">\((1 - p)\phi B\)</span> when no outbreak occurs but future benefit remains</li>
</ul>
<p>The cost <span class="math inline">\(C\)</span> is always incurred. So the <strong>net expected benefit</strong> is:</p>
<p><span class="math display">\[
\text{Net}_{\text{pre}} = pB + (1 - p)\phi B - C
\]</span></p>
</section>
<section id="reactive-vaccination-1" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="reactive-vaccination-1"><span class="header-section-number">4.2</span> Reactive Vaccination</h3>
<p>Reactive benefit occurs only if an outbreak occurs. In that case:</p>
<ul>
<li>Benefit: <span class="math inline">\(rB\)</span> and <span class="math inline">\(\phi B\)</span> with probability <span class="math inline">\(p\)</span></li>
<li>Cost: <span class="math inline">\(C\)</span> with probability <span class="math inline">\(p\)</span></li>
<li>Penalty (waste): <span class="math inline">\(D\)</span> with probability <span class="math inline">\((1 - p)\)</span></li>
</ul>
<p>So the net expected benefit is:</p>
<p><span class="math display">\[
\text{Net}_{\text{react}} = p(r+\phi)B - pC - (1 - p)D
\]</span></p>
<p>Compare symbolically both strategies under these extended conditions.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define symbols</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>B, C, D, p, r, phi <span class="op">=</span> sp.symbols(<span class="st">'B C D p r phi'</span>, positive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Net benefits</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>net_pre   <span class="op">=</span> p<span class="op">*</span>B <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> p)<span class="op">*</span>phi<span class="op">*</span>B <span class="op">-</span> C</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>net_react <span class="op">=</span> p<span class="op">*</span>(r<span class="op">+</span>phi)<span class="op">*</span>B <span class="op">-</span> p<span class="op">*</span>C <span class="op">-</span> (<span class="dv">1</span> <span class="op">-</span> p)<span class="op">*</span>D</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Difference</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>diff <span class="op">=</span> net_pre <span class="op">-</span> net_react</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>sp.simplify(diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>-B*p*(phi + r) + B*p - B*phi*(p - 1) + C*p - C - D*(p - 1)</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>threshold_p <span class="op">=</span> sp.solve(diff <span class="op">&gt;</span> <span class="dv">0</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[
\text{Net}_{\text{pre}} - \text{Net}_{\text{react}} = Bp(1 - r - \phi) + B(1 - p)\phi - C(1 - p) + D(1 - p)
\]</span></p>
<p>Pre-emptive vaccination is better when this expression is positive. The threshold for <span class="math inline">\(p\)</span> can be derived based on values of <span class="math inline">\(B, C, D, r, \phi\)</span>:</p>
<p><span class="math display">\[
p &gt; \frac{- \phi B + C - D}{(1- 2 \phi - r)B + C - D}
\]</span></p>
</section>
<section id="visualizing-the-scenario" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="visualizing-the-scenario"><span class="header-section-number">4.3</span> Visualizing the scenario</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fl">0.02</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>r_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>p_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>compute_net <span class="ot">&lt;-</span> <span class="cf">function</span>(p, r) {</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  net_pre   <span class="ot">&lt;-</span> B <span class="sc">*</span> p <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> B <span class="sc">*</span> phi <span class="sc">-</span> C</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  net_react <span class="ot">&lt;-</span> B <span class="sc">*</span> p <span class="sc">*</span> (r <span class="sc">+</span> phi)  <span class="sc">-</span> p <span class="sc">*</span> C <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> D</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">p =</span> p, <span class="at">r =</span> r,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">net_pre =</span> net_pre,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">net_react =</span> net_react))</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute threshold for each r</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">p =</span> p_vals, <span class="at">r =</span> r_vals)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> grid <span class="sc">%&gt;%</span> </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pre =</span> <span class="fu">compute_net</span>(p,r)<span class="sc">$</span>net_pre,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">react =</span> <span class="fu">compute_net</span>(p,r)<span class="sc">$</span>net_react,</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">decision =</span> <span class="fu">ifelse</span>(pre <span class="sc">&gt;</span> react, <span class="st">"Preemptive"</span>, <span class="st">"Reactive"</span>))</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot heatmap</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(grid, <span class="fu">aes</span>(<span class="at">x =</span> r, <span class="at">y =</span> p, <span class="at">fill =</span> decision)) <span class="sc">+</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Preemptive"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"Reactive"</span> <span class="ot">=</span> <span class="st">"tomato"</span>)) <span class="sc">+</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Vaccination Strategy Decision Heatmap"</span>,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Relative Reactive Benefit (r)"</span>,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Outbreak Probability (p)"</span>,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Strategy"</span>) <span class="sc">+</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="extending-to-multiple-sub-populations" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="extending-to-multiple-sub-populations"><span class="header-section-number">5</span> Extending to Multiple Sub-populations</h2>
<p>Let’s now generalize to <span class="math inline">\(k\)</span> sub-populations, each with its own outbreak probability <span class="math inline">\(p_i\)</span>. We have <span class="math inline">\(m\)</span> campaigns to deploy:</p>
<ul>
<li>Assign <span class="math inline">\(m_{\text{pre}}\)</span> campaigns pre-emptively</li>
<li>Leave <span class="math inline">\(m_{\text{react}} = m - m_{\text{pre}}\)</span> campaigns for reactive use</li>
</ul>
<section id="strategy" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="strategy"><span class="header-section-number">5.1</span> Strategy:</h3>
<ul>
<li>Sort sub-populations by descending <span class="math inline">\(p_i\)</span></li>
<li>Pre-emptively vaccinate top <span class="math inline">\(m_{\text{pre}}\)</span> if <span class="math inline">\(p_i &gt; \frac{- \phi B+ C - D}{(1- 2 \phi - r)B + C - D}\)</span></li>
<li>Use remaining campaigns reactively</li>
</ul>
</section>
<section id="numerical-illustration" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="numerical-illustration"><span class="header-section-number">5.2</span> Numerical illustration</h3>
<p>We simulate 10 sub-populations with different outbreak probabilities and show how many campaigns should be used pre-emptively.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>p_i <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">runif</span>(<span class="dv">10</span>, <span class="fl">0.05</span>, <span class="fl">0.4</span>), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>threshold_p <span class="ot">&lt;-</span> <span class="cf">function</span>(B, C, r, phi, D) { (<span class="sc">-</span> phi <span class="sc">*</span> B <span class="sc">+</span> C <span class="sc">-</span> D)<span class="sc">/</span>((<span class="dv">1</span><span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>phi <span class="sc">-</span> r)<span class="sc">*</span>B <span class="sc">+</span> C <span class="sc">-</span> D)}</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>assign_campaigns <span class="ot">&lt;-</span> <span class="cf">function</span>(p_i, B, C, r, phi, D) {</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  p_star <span class="ot">&lt;-</span> <span class="fu">threshold_p</span>(B, C, r, phi, D)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  preemptive <span class="ot">&lt;-</span> <span class="fu">which</span>(p_i <span class="sc">&gt;</span> p_star)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">index =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p_i), <span class="at">p_i =</span> p_i,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">decision =</span> <span class="fu">ifelse</span>(p_i <span class="sc">&gt;</span> p_star, <span class="st">"pre-emptive"</span>, <span class="st">"reactive"</span>))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">assign_campaigns</span>(p_i, <span class="at">B=</span><span class="dv">1</span>, <span class="at">C=</span><span class="fl">0.4</span>, <span class="at">r=</span><span class="fl">0.4</span>, <span class="at">phi=</span><span class="fl">0.1</span>, <span class="at">D=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   index        p_i    decision
1      1 0.37797639 pre-emptive
2      2 0.37018212 pre-emptive
3      3 0.34065667 pre-emptive
4      4 0.30780591    reactive
5      5 0.29677267    reactive
6      6 0.27994730    reactive
7      7 0.27461093    reactive
8      8 0.23168358    reactive
9      9 0.15014884    reactive
10    10 0.09713331    reactive</code></pre>
</div>
</div>
</section>
</section>
<section id="further-extention" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="further-extention"><span class="header-section-number">6</span> Further extention</h2>
<p>We consider a strategic vaccination scenario where oral cholera vaccines (OCVs) are in limited supply. Specifically, the available stockpile is sufficient to cover only 10% of all subpopulations. Epidemiological data suggest that, within the anticipated time frame, fewer than 10% of subpopulations are likely to experience an outbreak. This implies that a fully reactive strategy—in which vaccines are deployed only in response to confirmed outbreaks—could, in principle, respond to all outbreaks without exceeding supply.</p>
<p>However, a recent risk assessment indicates that 20% of the population exceeds the outbreak probability threshold <span class="math inline">\(p^*\)</span> above which preemptive vaccination is expected to yield greater benefit than reactive vaccination for a given region.</p>
<p>This raises a strategic dilemma:</p>
<blockquote class="blockquote">
<p>Should all subpopulations above the preemptive threshold be vaccinated in advance, despite limited vaccine availability and the potential need for reactive response elsewhere?</p>
</blockquote>
<p>This scenario highlights the trade-off between targeting high-risk areas proactively versus preserving flexibility to respond where outbreaks actually occur, especially under uncertainty and supply constraints. That is, we need to consider an opportunity cost of preemptive vaccination under Limited vaccine supply.</p>
<section id="setting-and-assumptions" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="setting-and-assumptions"><span class="header-section-number">6.1</span> Setting and Assumptions</h3>
<ul>
<li><span class="math inline">\(n\)</span>: total number of subpopulations.</li>
<li><span class="math inline">\(M\)</span>: number of vaccine campaigns available.</li>
<li><span class="math inline">\(k\)</span>: number of regions chosen for preemptive vaccination.</li>
<li><span class="math inline">\(p_i\)</span>: outbreak probability in region <span class="math inline">\(i\)</span>, with $p_1 p_2 p_n $.</li>
</ul>
<p>Assumptions:</p>
<ul>
<li>You can identify top-<span class="math inline">\(k\)</span> highest-risk regions.</li>
<li>You can react to up to <span class="math inline">\(M - k\)</span> outbreaks in unvaccinated populations.</li>
<li>Outbreaks occur independently across regions.</li>
</ul>
</section>
<section id="expected-benefits" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="expected-benefits"><span class="header-section-number">6.2</span> Expected Benefits</h3>
<section id="preemptive-strategy" class="level4" data-number="6.2.1">
<h4 data-number="6.2.1" class="anchored" data-anchor-id="preemptive-strategy"><span class="header-section-number">6.2.1</span> Preemptive Strategy</h4>
<p>Vaccinate top <span class="math inline">\(k\)</span> high-risk regions:</p>
<p><span class="math display">\[\text{Benefit}_{\text{pre}} = \sum_{i=1}^{k} p_i B \]</span></p>
</section>
<section id="reactive-strategy" class="level4" data-number="6.2.2">
<h4 data-number="6.2.2" class="anchored" data-anchor-id="reactive-strategy"><span class="header-section-number">6.2.2</span> Reactive Strategy</h4>
<p>Let <span class="math inline">\(\mu_k = \sum_{i=k+1}^{n} p_i\)</span>: expected number of outbreaks in unvaccinated regions.</p>
<p>Expected reactive benefit (up to <span class="math inline">\(M - k\)</span> responses):</p>
<p><span class="math display">\[
\text{Benefit}_{\text{react}} = rB \cdot \min(M - k, \mu_k)
\]</span></p>
</section>
<section id="total-expected-benefit" class="level4" data-number="6.2.3">
<h4 data-number="6.2.3" class="anchored" data-anchor-id="total-expected-benefit"><span class="header-section-number">6.2.3</span> Total Expected Benefit</h4>
<p><span class="math display">\[
\text{Total Benefit}_k \approx B \left( \sum_{i=1}^{k} p_i + r \cdot \min(M - k, \mu_k) \right)
\]</span></p>
</section>
</section>
<section id="opportunity-cost-of-preemptive-vaccination" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="opportunity-cost-of-preemptive-vaccination"><span class="header-section-number">6.3</span> Opportunity Cost of Preemptive Vaccination</h3>
<p>Vaccinating region <span class="math inline">\(k+1\)</span> preemptively:</p>
<ul>
<li>Gain: <span class="math inline">\(p_{k+1} B\)</span></li>
<li>Lose: ability to respond reactively to one more outbreak</li>
</ul>
<p>Opportunity cost:</p>
<p><span class="math display">\[
\text{Opportunity Cost}(k+1) = rB \cdot \mathbb{P}(X_k \ge M - k)
\]</span></p>
<p>where <span class="math inline">\(X_k \sim \text{Binomial}(n - k, \bar{p}_k)\)</span> or <span class="math inline">\(\text{Poisson}(\mu_k)\)</span>.</p>
</section>
<section id="refined-decision-rule" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="refined-decision-rule"><span class="header-section-number">6.4</span> Refined Decision Rule</h3>
<p>Preemptively vaccinate region <span class="math inline">\(i\)</span> only if:</p>
<p><span class="math display">\[
p_i &gt; r \cdot \mathbb{P}(\text{reactive demand exceeds remaining doses})
\]</span></p>
<p>Using Poisson approximation:</p>
<p><span class="math display">\[
\mathbb{P}(X_k \ge M - k) \approx 1 - \sum_{x=0}^{M-k-1} \frac{e^{-\mu_k} \mu_k^x}{x!}
\]</span></p>
<p>So:</p>
<p><span class="math display">\[
\text{Opportunity Cost} \approx rB \left(1 - \sum_{x=0}^{M-k-1} \frac{e^{-\mu_k} \mu_k^x}{x!} \right)
\]</span></p>
</section>
<section id="summary-of-key-formulas" class="level3" data-number="6.5">
<h3 data-number="6.5" class="anchored" data-anchor-id="summary-of-key-formulas"><span class="header-section-number">6.5</span> Summary of Key Formulas</h3>
<table class="table">
<colgroup>
<col style="width: 42%">
<col style="width: 57%">
</colgroup>
<thead>
<tr class="header">
<th>Quantity</th>
<th>Expression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Preemptive threshold</td>
<td>$ p^* = $</td>
</tr>
<tr class="even">
<td>Preemptive benefit (k regions)</td>
<td>$_{i=1}^k p_i B $</td>
</tr>
<tr class="odd">
<td>Reactive expected benefit</td>
<td>$ rB (M-k, _k) $</td>
</tr>
<tr class="even">
<td>Total expected benefit</td>
<td>$ B ( _{i=1}^k p_i + r (M - k, _k) ) $</td>
</tr>
<tr class="odd">
<td>Opportunity cost of dose $ k+1 $</td>
<td>$ rB (X_k M - k) $</td>
</tr>
<tr class="even">
<td>Adjusted decision rule</td>
<td>Vaccinate if $ p_{k+1} &gt; r (X_k M - k) $</td>
</tr>
</tbody>
</table>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation parameters</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>                        <span class="co"># Total subpopulations</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10</span>                         <span class="co"># Vaccine budget (10% of regions)</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1</span>                          <span class="co"># Benefit of preventing an outbreak</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fl">0.4</span>                        <span class="co"># Cost of vaccination</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.8</span>                        <span class="co"># Relative reactive benefit</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Threshold for preemptive action</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>p_star <span class="ot">&lt;-</span> (<span class="sc">-</span> phi<span class="sc">*</span>B <span class="sc">+</span> C <span class="sc">-</span> D) <span class="sc">/</span> ((<span class="dv">1</span><span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>phi <span class="sc">-</span> r)<span class="sc">*</span>B <span class="sc">+</span> C <span class="sc">-</span> D)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># p_star &lt;- C / (B * (1 - r) + C) </span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate synthetic outbreak probabilities</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>p_i <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">runif</span>(n, <span class="fl">0.01</span>, <span class="fl">0.5</span>), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate outbreak events (Bernoulli trial based on p_i)</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>M) {</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Preemptively vaccinate top-k at-risk regions</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  preempt_indices <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>k</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  reactive_pool <span class="ot">&lt;-</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  total_cases_averted <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim) {</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    outbreaks <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p_i)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Preemptive: full benefit if outbreak occurs</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    preempt_impact <span class="ot">&lt;-</span> <span class="fu">sum</span>(outbreaks[preempt_indices]) <span class="sc">*</span> B</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reactive: respond to up to (M - k) actual outbreaks in unvaccinated group</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    reactive_indices <span class="ot">&lt;-</span> reactive_pool[outbreaks[reactive_pool] <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    max_reactive <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">length</span>(reactive_indices), M <span class="sc">-</span> k)</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    reactive_impact <span class="ot">&lt;-</span> max_reactive <span class="sc">*</span> r <span class="sc">*</span> B</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    total_cases_averted[s] <span class="ot">&lt;-</span> preempt_impact <span class="sc">+</span> reactive_impact</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results,</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">data.frame</span>(</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>                     <span class="at">k_preempt =</span> k,</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>                     <span class="at">mean_cases_averted =</span> <span class="fu">mean</span>(total_cases_averted),</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sd =</span> <span class="fu">sd</span>(total_cases_averted)</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>                   ))</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(results, <span class="fu">aes</span>(<span class="at">x =</span> k_preempt, <span class="at">y =</span> mean_cases_averted)) <span class="sc">+</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_cases_averted <span class="sc">-</span> sd,</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> mean_cases_averted <span class="sc">+</span> sd),</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Expected Cases Averted vs. Number of Preemptive Vaccinations"</span>,</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Preemptive Vaccinated Regions (k)"</span>,</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mean Cases Averted (with SD band)"</span>) <span class="sc">+</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation parameters</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>                        <span class="co"># Total subpopulations</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10</span>                         <span class="co"># Vaccine budget (10% of regions)</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1</span>                          <span class="co"># Benefit of preventing an outbreak</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fl">0.4</span>                        <span class="co"># Cost of vaccination</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Outbreak probabilities</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>p_i <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">runif</span>(n, <span class="fl">0.01</span>, <span class="fl">0.5</span>), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Sim settings</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>r_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.2</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.2</span>)  <span class="co"># Explore multiple r values</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (r <span class="cf">in</span> r_values) {</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Recalculate p_star (optional for reference)</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  p_star <span class="ot">&lt;-</span> (<span class="sc">-</span> phi<span class="sc">*</span>B <span class="sc">+</span> C <span class="sc">-</span> D) <span class="sc">/</span> ((<span class="dv">1</span><span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>phi <span class="sc">-</span> r)<span class="sc">*</span>B <span class="sc">+</span> C <span class="sc">-</span> D)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>M) {</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    preempt_indices <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>k</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    reactive_pool <span class="ot">&lt;-</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    total_cases_averted <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim) {</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>      outbreaks <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p_i)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Preemptive impact</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>      preempt_impact <span class="ot">&lt;-</span> <span class="fu">sum</span>(outbreaks[preempt_indices]) <span class="sc">*</span> B</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Reactive impact</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>      reactive_indices <span class="ot">&lt;-</span> reactive_pool[outbreaks[reactive_pool] <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>      max_reactive <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">length</span>(reactive_indices), M <span class="sc">-</span> k)</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>      reactive_impact <span class="ot">&lt;-</span> max_reactive <span class="sc">*</span> r <span class="sc">*</span> B</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>      total_cases_averted[s] <span class="ot">&lt;-</span> preempt_impact <span class="sc">+</span> reactive_impact</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results,</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">data.frame</span>(</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>                       <span class="at">r =</span> r,</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k_preempt =</span> k,</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mean_cases_averted =</span> <span class="fu">mean</span>(total_cases_averted),</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sd =</span> <span class="fu">sd</span>(total_cases_averted)</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>                     ))</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(results, <span class="fu">aes</span>(<span class="at">x =</span> k_preempt, <span class="at">y =</span> mean_cases_averted, <span class="at">color =</span> <span class="fu">factor</span>(r))) <span class="sc">+</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_cases_averted <span class="sc">-</span> sd,</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> mean_cases_averted <span class="sc">+</span> sd,</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="fu">factor</span>(r)), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Expected Cases Averted by Preemptive Vaccination and Reactive Effectiveness"</span>,</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Preemptive Vaccinated Regions (k)"</span>,</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mean Cases Averted (with SD band)"</span>,</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Reactive effectiveness (r)"</span>,</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Reactive effectiveness (r)"</span>) <span class="sc">+</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'top'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="further-extention-1" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="further-extention-1"><span class="header-section-number">7</span> Further Extention</h2>
<p>We consider a constrained setting where <span class="math inline">\(r\)</span> is not fixed and depends on the <strong>duration</strong> of the outbreak, in addition to the previous version.</p>
<p>Longer outbreaks allow more time for detection and response, and thus yield more effective reactive campaigns. We model <span class="math inline">\(r\)</span> as a function of outbreak duration <span class="math inline">\(d\)</span>, i.e., <span class="math inline">\(r = f(d)\)</span>.</p>
<section id="assumptions" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="assumptions"><span class="header-section-number">7.1</span> Assumptions</h3>
<ul>
<li><span class="math inline">\(r(d) = \frac{\log(d + 1)}{\log(d_{\text{max}} + 1)}\)</span>, normalized so that <span class="math inline">\(r \in [0,1]\)</span> for durations <span class="math inline">\(d \in [1, d_{\text{max}}]\)</span>.</li>
<li><span class="math inline">\(d \sim \text{Gamma}(\alpha, \beta)\)</span> — outbreak durations follow a Gamma distribution.</li>
<li>Vaccine stockpile is sufficient for <span class="math inline">\(M = 10\%\)</span> of <span class="math inline">\(n\)</span> subpopulations.</li>
<li>20% of subpopulations have <span class="math inline">\(p_i &gt; p^*\)</span>.</li>
</ul>
</section>
<section id="threshold-probability-for-preemptive-vaccination" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="threshold-probability-for-preemptive-vaccination"><span class="header-section-number">7.2</span> Threshold Probability for Preemptive Vaccination</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation parameters</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Control parameter for r(d)</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">1.4</span>  <span class="co"># &gt;1: delayed growth, &lt;1: rapid saturation</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Outbreak probabilities</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>p_i <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">runif</span>(n, <span class="fl">0.01</span>, <span class="fl">0.9</span>), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Duration depends on p_i</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>min_d <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>max_d <span class="ot">&lt;-</span> <span class="dv">156</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>duration <span class="ot">&lt;-</span> min_d <span class="sc">+</span> (max_d <span class="sc">-</span> min_d) <span class="sc">*</span> (p_i <span class="sc">-</span> <span class="fu">min</span>(p_i)) <span class="sc">/</span> (<span class="fu">max</span>(p_i) <span class="sc">-</span> <span class="fu">min</span>(p_i))</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Reactive effectiveness with parameter alpha</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>r_d <span class="ot">&lt;-</span> ((duration <span class="sc">-</span> min_d) <span class="sc">/</span> (max_d <span class="sc">-</span> min_d)) <span class="sc">^</span> alpha</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>r_d <span class="ot">&lt;-</span> <span class="fu">pmin</span>(r_d, <span class="dv">1</span>)  <span class="co"># cap at 1</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional preview</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(p_i, r_d, type = "l")</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation loop</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>M) {</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  preempt_indices <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>k</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  reactive_pool <span class="ot">&lt;-</span> (k <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>  total_cases_averted <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim) {</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    outbreaks <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p_i)</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Preemptive impact</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    preempt_impact <span class="ot">&lt;-</span> <span class="fu">sum</span>(outbreaks[preempt_indices]) <span class="sc">*</span> B</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reactive impact</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    reactive_indices <span class="ot">&lt;-</span> reactive_pool[outbreaks[reactive_pool] <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>    reactive_impact <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">length</span>(reactive_indices) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>      top_reactive <span class="ot">&lt;-</span> <span class="fu">head</span>(reactive_indices, M <span class="sc">-</span> k)</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(r_d[top_reactive] <span class="sc">*</span> B)</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    total_cases_averted[s] <span class="ot">&lt;-</span> preempt_impact <span class="sc">+</span> reactive_impact</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">k_preempt =</span> k,</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_cases_averted =</span> <span class="fu">mean</span>(total_cases_averted),</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(total_cases_averted)</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot simulation result</span></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(results, <span class="fu">aes</span>(<span class="at">x =</span> k_preempt, <span class="at">y =</span> mean_cases_averted)) <span class="sc">+</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_cases_averted <span class="sc">-</span> sd,</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> mean_cases_averted <span class="sc">+</span> sd),</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Expected Cases Averted vs. k (alpha = "</span>, alpha, <span class="st">")"</span>),</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Preemptively Vaccinated Regions (k)"</span>,</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mean Cases Averted (with SD)"</span>) <span class="sc">+</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="interpretation-1" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="interpretation-1"><span class="header-section-number">7.3</span> Interpretation</h3>
<ul>
<li><strong>Short-duration outbreaks</strong> yield <strong>lower reactive effectiveness</strong> <span class="math inline">\(r(d)\)</span> → lower <span class="math inline">\(p^*\)</span> → favoring <strong>preemptive vaccination</strong>.</li>
<li><strong>Longer-duration outbreaks</strong> increase <span class="math inline">\(r(d)\)</span> → raising <span class="math inline">\(p^*\)</span> → making <strong>reactive vaccination more attractive</strong>.</li>
<li>With only 10% vaccine supply, we cannot preemptively cover all high-risk regions.</li>
<li>This creates an <strong>opportunity cost</strong>: vaccinating low-duration regions may reduce capacity to respond to longer ones where reactive strategies might succeed.</li>
</ul>
</section>
<section id="summary-of-final-model" class="level3" data-number="7.4">
<h3 data-number="7.4" class="anchored" data-anchor-id="summary-of-final-model"><span class="header-section-number">7.4</span> Summary of Final Model</h3>
<table class="table">
<colgroup>
<col style="width: 47%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(r(d)\)</span></td>
<td>Duration-dependent effectiveness of reactive vaccination</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\phi\)</span></td>
<td>Benefit from proactive vaccination even if no outbreak</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(D\)</span></td>
<td>Cost of unused vaccine under reactive plan</td>
</tr>
<tr class="even">
<td><span class="math inline">\(p^*\)</span></td>
<td>Threshold outbreak probability above which preemptive vaccination is favored</td>
</tr>
</tbody>
</table>
<p>Final threshold formula:</p>
<p><span class="math display">\[{p^* = \frac{- \phi B + C - D}{(1 - 2\phi - r(d)) B + C - D}}\]</span></p>
<p>This formulation reflects <strong>operational complexity</strong>, <strong>vaccine scarcity</strong>, and <strong>time-sensitive effectiveness</strong>, guiding more nuanced vaccine allocation strategies in outbreak-prone settings.</p>
</section>
</section>
<section id="discussion" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="discussion"><span class="header-section-number">8</span> Discussion</h2>
<p>When outbreak risk is high enough, <strong>pre-emptive vaccination</strong> pays off even if the outbreak doesn’t occur. When outbreak risk is low, and <strong>reactive</strong> campaigns are effective (<span class="math inline">\(r\)</span> close to 1) and is more cost-effective. The decision threshold depends critically on the relative cost <span class="math inline">\(C\)</span> and the delay penalty <span class="math inline">\((1 - r)\)</span> in addition to <span class="math inline">\(p\)</span> and <span class="math inline">\(r\)</span></p>
</section>
<section id="conclusion" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">9</span> Conclusion</h2>
<p>Even under limited vaccine supply, careful cost-benefit modeling can guide whether to vaccinate early or wait. This blog post outlined a tractable analytical framework and practical tools (in Python and R) to support such decisions. Extensions could include waning immunity, spatial correlations, or dynamic outbreaks.</p>
</section>
<section id="references" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="references"><span class="header-section-number">10</span> References</h2>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="kimfinale/myblog" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>